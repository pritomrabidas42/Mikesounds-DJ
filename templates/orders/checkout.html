<h2>Checkout</h2>

<h3>Items</h3>
<table border="1" cellpadding="5">
<tr>
<th>Product</th><th>Variation</th><th>Quantity</th><th>Unit Price</th><th>Total</th>
</tr>
{% for item in items %}
<tr>
<td>{{ item.product.title }}</td>
<td>
{% if item.variation %} {{ item.variation.size }} {% else %} Default {% endif %}
</td>
<td>{{ item.quantity }}</td>
<td>{{ item.unit_price }}</td>
<td>{{ item.line_total }}</td>
</tr>
{% endfor %}
</table>

<h3>Shipping Address</h3>
<form method="POST" action="{% url 'place_order' %}">
{% csrf_token %}
<input name="name" placeholder="Full Name" required>
<input name="email" placeholder="Email" required>
<input name="phone" placeholder="Phone" required>
<input name="country" placeholder="Country" required>
<input name="city" placeholder="City" required>
<input name="postal_code" placeholder="Postal Code" required>
<textarea name="street" placeholder="Street Address" required></textarea>

<p>Subtotal: {{ subtotal }}</p>
<p>Shipping Fee: {{ shipping_fee }}</p>
<p>Discount: {{ discount }}</p>
<p><strong>Grand Total: {{ grand_total }}</strong></p>

<button type="submit">Place Order</button>
</form>

{% if order %}
<h3>Payment</h3>
<p>Amount to pay: {{ order.grand_total }}</p>
<form method="GET" action="{% url 'payment_init' order.id 'nogod' %}">
<button type="submit">Pay with Nagad</button>
</form>
<form method="GET" action="{% url 'payment_init' order.id 'bkash' %}">
<button type="submit">Pay with Bkash</button>
</form>
<form method="GET" action="{% url 'payment_init' order.id 'rocket' %}">
<button type="submit">Pay with Rocket</button>
</form>
{% endif %}
